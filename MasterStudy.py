# @author : biulove0x
# @name   : WP Plugins Master Study Exploiter
# @tg     : @biulove0x
from urllib3.exceptions import InsecureRequestWarning
import concurrent.futures
import sys, requests, re, argparse

print(
'''
###############################################
# @author : biulove0x                         #
# @name   : WP Plugins Master Study Exploiter #
# @cve    : CVE-2022-0441                     #
###############################################
''')

def masterstudy(_target, timeout=10):
    print()

def main(_choose, _target):
    if _choose == 1:
        masterstudy(_target)

    elif _choose == 2:
        with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:
            _ur_list = open(_target, 'r').read().split()
            _futures = []

            for _url in _ur_list:
                _futures.append(executor.submit(masterstudy, target=_url))

            for _future in concurrent.futures.as_completed(_futures):
                if(_future.result() is not None):
                    print(_future.result())
    else:
        exit()

## Setup args
_parser = argparse.ArgumentParser(description='CVE-2022-0441 [ WordPress Plugin MasterStudy LMS 2.7.5 - Unauthenticated Admin Account Creation ]')
_parser.add_argument('-t', metavar='example.com', type=str, help='Single target')
_parser.add_argument('-l', metavar='target.txt', type=str, help='Multiple target')
_args = _parser.parse_args()

## Variable args
_singleTarget = _args.t
_multiTarget  = _args.l

if __name__ == '__main__':
    if not _singleTarget == None:
        _choose = 1
        main(_choose)
    elif not _multiTarget == None:
        _choose = 2
        main(_choose, _multiTarget)
    else:
        print('MasterStudy.py --help for using tools')
